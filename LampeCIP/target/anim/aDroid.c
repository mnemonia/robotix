
/*********************************************************************
	SYSTEM Droid
	visual ANIMATION Droid
	Connector Module (main) for CIP MACHINE mDroid
	Filename: aDroid.c
	generated by CIP Tool(R) Version 4.41.00
		January 6, 2012  10:47:34 am
	activated code options:
		PENDING_ information
		call context error function
		call buffer warning function
		call buffer error function
		enable MODE inspection
		name dictionary files
		C-code
*********************************************************************/

/* Include Files */

#include "mDroid.h"

#include "eDroid.h"

/* Shared Library Export Symbols */

__declspec(dllexport)
	void fINIT_ShowProcessCb(CbShowProcess_ vwCbShowProcess_);
__declspec(dllexport)
	void fINIT_ErrorCb(CbEContext_ vwCbEContext_, CbEFullbuff_ vwCbEFullbuff_, CbEBuffer_ vwCbEBuffer_);
__declspec(dllexport)
	void fINIT_TraceCbPut (CbTPutString_ vwCbTPutString_);
__declspec(dllexport)
	void fCALL_Channel_(int channel_, int message_, ...);
__declspec(dllexport)
	int fINIT_Machine(void);
__declspec(dllexport)
	int fINIT_(void);
__declspec(dllexport)
	int libraryIdent_ = 38854;
__declspec(dllexport)
	StatusField_ * statusPointer_;
__declspec(dllexport)
	TransitionField_ * transitionPointer_;
__declspec(dllexport)
	struct tPENDING_ * pendingPointer_;
__declspec(dllexport)
	CbShowProcess_ cCbShowProcess_;
__declspec(dllexport)
	CbEContext_ cCbEContext_;
	CbEFullbuff_ cCbEFullbuff_;
	CbEBuffer_ cCbEBuffer_;
__declspec(dllexport)
	CbTPutString_ cCbTPutString_;


/* External Declarations */



/* Global Declarations */

CbShowProcess_ cCbShowProcess_;
CbEContext_ cCbEContext_;
CbEFullbuff_ cCbEFullbuff_;
CbEBuffer_ cCbEBuffer_;
CbTPutString_ cCbTPutString_;

StatusField_ statusArray_[1];
TransitionField_ transitionArray_[1];
struct tINPUT_ INPUT_mDroid;

/* Function Prototypes */

void uCHAN_Lampe (int name_);
void uECONTXT_(struct tCONTXT_ *error_);
void uFULLBUF_(void);
void uEBUFFER_(struct tBUFFER_ *error_);
void fCALL_Channel_(int channel_, int message_, ...);

/* Channel Functions for Animation Output */

void uCHAN_Lampe (int name_)
{
	if (name_){};    /* dummy statement */
}

/* Interface Functions for Error Handling */

void uECONTXT_(struct tCONTXT_ *error_)
{
	cCbEContext_(error_->process_, error_->channel_, error_->message_);
}

void uFULLBUF_(void)
{
	cCbEFullbuff_();
}

void uEBUFFER_(struct tBUFFER_ *error_)
{
	cCbEBuffer_(error_->channel_, error_->message_);
}

/* Initialization of Error Function Interface */

void fINIT_ErrorCb(CbEContext_ vwCbEContext_, CbEFullbuff_ vwCbEFullbuff_, CbEBuffer_ vwCbEBuffer_)
{
	cCbEContext_ = vwCbEContext_;
	cCbEFullbuff_ = vwCbEFullbuff_;
	cCbEBuffer_ = vwCbEBuffer_;
}

void iERROR_(void)
{
	#ifdef _ECONTXT__
		ERR_.ECONTXT_ = uECONTXT_;
	#endif 

	#ifdef _FULLBUF__
		ERR_.FULLBUF_ = uFULLBUF_;
	#endif 

	#ifdef _EBUFFER__
		ERR_.EBUFFER_ = uEBUFFER_;
	#endif 
}

/* Input and Output Object Initialization Function */

void fINIT_ShowProcessCb(CbShowProcess_ vwCbShowProcess_)
{
	cCbShowProcess_ = vwCbShowProcess_;
	statusPointer_ = &statusArray_[0];
	transitionPointer_ = &transitionArray_[0];
	pendingPointer_ = &TRG_.PENDING_;
}

void iCHAN_(void)
{
		/* Initializing Input Error Function only if Input Error Option set */

	#ifdef _EINPUT__
		IN_.EINPUT_ = uEINPUT_;
	#endif 

		/* Initializing Output Interface */

	OUT_.Lampe = uCHAN_Lampe;
}

/* Trace Initialization Function */

void fINIT_TraceCbPut (CbTPutString_ vwCbTPutString_)
{
	cCbTPutString_ = vwCbTPutString_;
}

/* CIP Machine Initialization Function */

int fINIT_Machine(void)
{
	return fINIT_();
}

/* Input Handler Function for Animation Input */

void fCALL_Channel_(int channel_, int message_, ...)
{
	int ticks_;
	switch (channel_)
	{
	case C_Schalter:
		INPUT_mDroid.name_ = message_;
		IN_.Schalter(INPUT_mDroid.name_);
		break;
	case -1:
		for (ticks_ =1; ticks_<=message_; ticks_++)
			TRG_.TICK_();
		break;
	case -2:
		TRG_.CHAIN_();
		break;
	case -3:
		TRG_.TIMEUP_();
		break;
	case -4:
		TRG_.READ_();
		break;
	default: 
		break;
	}
	return;
}

/*********************************************************************
	End of Connector Module for CIP MACHINE mDroid
*********************************************************************/
