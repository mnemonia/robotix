
/*********************************************************************
	SYSTEM Fhotibot
	Module for PROCESS Finder
	Filename: Finder.c
	generated by CIP Tool(R) Version 4.41.00
		February 15, 2012  12:14:05 am
	activated code options:
		'unsigned char' for 'enum'
		C-code
*********************************************************************/

/* Include Files */

#include "mTheUnit.h"

/* Process Macro Definitions */

#define SELF status_Finder.write_access_
#define STATUS status_Finder.read_access_
#define TIME time_mTheUnit

/* Process Definitions */

/* MODES */
#define Suspend 1
#define Normal 2

/* STATES */
#define AvoidObstacle 1
#define Find 2


/* INPULSES */
#define IP_ClearOfObstacle 1
#define IP_AvoidingObstacle 2
#define IP_ToTheLeft 3
#define IP_ToTheRight 4
#define IP_Ahead 5
#define IP_Behind 6
#define IP_Unknown 7


/* OUTPULSES */

#define O15_AvoidingObstacle 5
#define O15_ClearOfObstacle 6
#define O7_Ahead 1
#define O7_Behind 2
#define O7_ToTheLeft 4
#define O7_ToTheRight 3
#define O7_Unknown 7

/* External Declarations */

extern unsigned long time_mTheUnit;
extern union tCHNOUT_mTheUnit CHNOUT_mTheUnit;
extern union tSTATUS_DriveObserver status_DriveObserver;


/* Global Declarations */

union tSTATUS_Finder status_Finder;
const unsigned char MODTAB_Finder[2] =       /*  [DriveObserver states] */
	{1, 2};

/* Function Prototypes */

int fPULSE_Finder (unsigned char name_);
void fINIT_Finder (void);

/* Input Channel Functions */

int fPULSE_Finder (unsigned char name_)
{
	switch (name_)
	{
		/***  INPULSE Ahead  ***/
	case O7_Ahead:		/***  PULSE CAST from PROCESS TargetDirection  ***/
		switch (MODTAB_Finder[status_DriveObserver.read_access_.STATE -1])
		{
		case 2:  /* MODE Normal */
			switch (status_Finder.read_access_.STATE)
			{
			case 2:  /* STATE Find */
				status_Finder.write_access_.STATE = 2;  /* STATE Find */
				CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_ = C7_Forward;
				OUT_.RemoteControlEvents (CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_);
				break;
			default: 
				break;
			}
			break;
		default: 
			break;
		}
		break;
		/***  INPULSE AvoidingObstacle  ***/
	case O15_AvoidingObstacle:		/***  PULSE CAST from PROCESS DriveObserver  ***/
		switch (MODTAB_Finder[status_DriveObserver.read_access_.STATE -1])
		{
		case 1:  /* MODE Suspend */
			switch (status_Finder.read_access_.STATE)
			{
			case 2:  /* STATE Find */
				status_Finder.write_access_.STATE = 1;  /* STATE AvoidObstacle */
				break;
			default: 
				break;
			}
			break;
		default: 
			break;
		}
		break;
		/***  INPULSE Behind  ***/
	case O7_Behind:		/***  PULSE CAST from PROCESS TargetDirection  ***/
		switch (MODTAB_Finder[status_DriveObserver.read_access_.STATE -1])
		{
		case 2:  /* MODE Normal */
			switch (status_Finder.read_access_.STATE)
			{
			case 2:  /* STATE Find */
				status_Finder.write_access_.STATE = 2;  /* STATE Find */
				CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_ = C7_Backward;
				OUT_.RemoteControlEvents (CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_);
				break;
			default: 
				break;
			}
			break;
		default: 
			break;
		}
		break;
		/***  INPULSE ClearOfObstacle  ***/
	case O15_ClearOfObstacle:		/***  PULSE CAST from PROCESS DriveObserver  ***/
		switch (MODTAB_Finder[status_DriveObserver.read_access_.STATE -1])
		{
		case 2:  /* MODE Normal */
			switch (status_Finder.read_access_.STATE)
			{
			case 1:  /* STATE AvoidObstacle */
				status_Finder.write_access_.STATE = 2;  /* STATE Find */
				break;
			default: 
				break;
			}
			break;
		case 1:  /* MODE Suspend */
			switch (status_Finder.read_access_.STATE)
			{
			case 1:  /* STATE AvoidObstacle */
				status_Finder.write_access_.STATE = 2;  /* STATE Find */
				break;
			default: 
				break;
			}
			break;
		default: 
			break;
		}
		break;
		/***  INPULSE ToTheLeft  ***/
	case O7_ToTheLeft:		/***  PULSE CAST from PROCESS TargetDirection  ***/
		switch (MODTAB_Finder[status_DriveObserver.read_access_.STATE -1])
		{
		case 2:  /* MODE Normal */
			switch (status_Finder.read_access_.STATE)
			{
			case 2:  /* STATE Find */
				status_Finder.write_access_.STATE = 2;  /* STATE Find */
				CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_ = C7_Left;
				OUT_.RemoteControlEvents (CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_);
				break;
			default: 
				break;
			}
			break;
		default: 
			break;
		}
		break;
		/***  INPULSE ToTheRight  ***/
	case O7_ToTheRight:		/***  PULSE CAST from PROCESS TargetDirection  ***/
		switch (MODTAB_Finder[status_DriveObserver.read_access_.STATE -1])
		{
		case 2:  /* MODE Normal */
			switch (status_Finder.read_access_.STATE)
			{
			case 2:  /* STATE Find */
				status_Finder.write_access_.STATE = 2;  /* STATE Find */
				CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_ = C7_Right;
				OUT_.RemoteControlEvents (CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_);
				break;
			default: 
				break;
			}
			break;
		default: 
			break;
		}
		break;
		/***  INPULSE Unknown  ***/
	case O7_Unknown:		/***  PULSE CAST from PROCESS TargetDirection  ***/
		switch (MODTAB_Finder[status_DriveObserver.read_access_.STATE -1])
		{
		case 2:  /* MODE Normal */
			switch (status_Finder.read_access_.STATE)
			{
			case 2:  /* STATE Find */
				status_Finder.write_access_.STATE = 2;  /* STATE Find */
				CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_ = C7_Stop;
				OUT_.RemoteControlEvents (CHNOUT_mTheUnit.CHAN_RemoteControlEvents.name_);
				break;
			default: 
				break;
			}
			break;
		default: 
			break;
		}
		break;
	default: 
		return 0;
	}
	return 1;
}

/* Process Initialization Function */

void fINIT_Finder (void)
{
	status_Finder.write_access_.STATE = 2;  /* STATE Find */
}

/*********************************************************************
	End of Module for PROCESS Finder
*********************************************************************/
